<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asteroides</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <canvas id="myCanvas">Your browser does not support the HTML5 canvas tag. </canvas>
	<div class="menu">
		<h1>Asteroides</h1>
		<button id="btn">Play</button>
		<button id="btnclose">Quit</button>
	</div>
    <div class="submenu" style="visibility:hidden">
        <button>||</button>
        <button>Restart</button>
        <button>X</button>
    </div>
	<script>
		var canvas = document.getElementById('myCanvas')
        //set canvas in full page
        canvas.width  = window.innerWidth;
        canvas.height = window.innerHeight
		var ctx = canvas.getContext('2d');
		const W = canvas.width;
        const H = canvas.height;
		let img = new Image();
		img.src = 'https://i.ytimg.com/vi/y2_2Lcl5Iow/maxresdefault.jpg';
		ctx.drawImage(img, 0, 0,W,H);
        //set keys value
        let rightKey = false, leftKey = false, upKey = false, downKey = false;
        //load page
		class Asteroides {
            constructor(x, y, r, d, c) { // CONSTRUCTOR
                this.x = x; // initial X position
                this.y = y; // initial Y position
                if(r=="60"){
                     // (constant) horizontal displacement(velocity): d is a direction angle
                    this.dX = 2 * Math.cos(d);
                    // (constant) vertical displacement (velocity): d is a direction angle
                    this.dY = 2 * Math.sin(d);
                }
                else{
                     // (constant) horizontal displacement(velocity): d is a direction angle
                    this.dX = 5 * Math.cos(d);
                    // (constant) vertical displacement (velocity): d is a direction angle
                    this.dY = 5 * Math.sin(d);
                }
               
                this.c = c; // color
                this.R = r; // circle radius(constant)
            }

            draw() {
                ctx.strokeStyle = this.c;
                var numberOfSides = 8;
                var angle = 2 * Math.PI / numberOfSides;
                ctx.save()
                ctx.beginPath();
                ctx.translate(this.x, this.y);
                //rotation of asteroides
                if(this.R=="60"){
                    ctx.rotate(angleS * Math.PI / 180)
                }
                else{
                    ctx.rotate(angleS*Math.PI/40)
                }
                
                ctx.moveTo(this.R, 0);
                for (var i = 1; i <= numberOfSides; i++) {
                    ctx.lineTo(this.R * Math.cos(i * angle), this.R * Math.sin(i * angle));
                }
                ctx.lineWidth = 3
                ctx.stroke()
                ctx.restore()
            }

            update() {
               // check Canvas vertical collisions
                if (this.x < -this.R)
                    this.x = W + this.R;

                if (this.x > W + this.R)
                    this.x = -this.R;

                // check Canvas horizontal collisions
                if (this.y < -this.R)
                    this.y = H + this.R;

                if (this.y > H + this.R)
                    this.y = -this.R;

                this.x += this.dX; // update horizontal position
                this.y += this.dY; // update vertical position
            }
        }
        class Nav{
            constructor(x,y,r,c){
                this.x=x;
                this.y=y;
                this.r=r;
                this.c=c;

            }
            drawN() {
                ctx.strokeStyle = this.c;
                var numberOfSidesNav = 3;
		        var angleNav = 2*Math.PI/numberOfSidesNav;
                ctx.save()
                ctx.beginPath();
                ctx.translate(this.x, this.y);
                ctx.rotate(angleSNav * Math.PI / 180)
		        ctx.moveTo(0, -this.r);          
		        ctx.lineTo(this.r*Math.cos(1 * Math.PI/3), this.r*Math.sin(1 * Math.PI/3));
		        ctx.lineTo(this.r*Math.cos(2 * Math.PI/3), this.r*Math.sin(2 * Math.PI/3));
                ctx.closePath();
                ctx.lineWidth = 3
 		        ctx.stroke();
                ctx.restore()
            }
            updateN(){
                //update position
                if (rightKey && this.x + this.r < W)
                angleSNav++ ;
                if (leftKey && this.x - this.r > -this.r)
                angleSNav--;
                if (upKey )
                {
                    this.x += 2 * Math.cos(angleSNav* Math.PI / 180 - Math.PI/2)
                    this.y += 2 * Math.sin(angleSNav* Math.PI / 180 - Math.PI/2)
                }
            }

        }
        let a = new Array();
        let n= new Array()
        let list = [60, 30] 
        for (let i = 0; i < 25; i++) {
            let x = Math.floor(Math.random() * (1 - 0 + 1)) + 0;
            let radius = list[x]
            let color = `white`;
            // randomposition (inside Canvas)
            let xInit = 20 + Math.random() * (W - 2 * 20);
            let yInit = 20 + Math.random() * (H - 2 * 20);
            // randomdirection
            let direction = Math.random() * 2 * Math.PI;
            a.push(new Asteroides(xInit, yInit, radius, direction, color))
        }
        let angleS=0
        let angleSNav=0
        function render() {
            // fade Canvas
			ctx.fillStyle="transparent"
            ctx.drawImage(img, 0, 0,W,H);
            ctx.fillRect(0, 0, W, H);
            // draw & update
            a.forEach(asteroide => {
                asteroide.draw();
                asteroide.update();
            });

            n.forEach(nav => {
                nav.drawN();
                nav.updateN();
            });
            
            angleS++;
            //new frame
            window.requestAnimationFrame(render);
        }
        render(); //startthe animation

        //listen events of menu
		let btn=document.querySelector("#btn")
		btn.addEventListener("click",function(){
			startGame()
		}) 
        let btnClose=document.querySelector("#btnclose")
        btnClose.addEventListener("click",function(){
            window.close()
        }) 
        //startGame
         // on key DOWN, check if it is an arrow, and signal the corresponding flag
        function startGame(){
            let menu=document.querySelector(".menu")
            menu.style.visibility='hidden'
            //set events for keys
            window.addEventListener('keydown', e => {
            if (e.key == 'ArrowRight')
                rightKey = true;
            if (e.key == 'ArrowLeft')
                leftKey = true;

            if (e.key == 'ArrowDown')
                downKey = true;
            if (e.key == 'ArrowUp')
                upKey = true;

            e.preventDefault();
            });

            // on key UP, check if it is an arrow, and signal the corresponding flag
            window.addEventListener('keyup', e => {
            if (e.key == 'ArrowRight')
                rightKey = false;
            if (e.key == 'ArrowLeft')
                leftKey = false;

            if (e.key == 'ArrowDown')
                downKey = false;
            if (e.key == 'ArrowUp')
                upKey = false;
            });
            //set asteroides
            a=new Array
            let list = [60, 30] 
            for (let i = 0; i < 2; i++) {
            let x = Math.floor(Math.random() * (1 - 0 + 1)) + 0;
            let radius = list[x]
            let color = `white`;
            // randomposition (inside Canvas)
            let xInit = 20 + Math.random() * (W - 2 * 20);
            let yInit = 20 + Math.random() * (H - 2 * 20);
            // randomdirection
            let direction = Math.random() * 2 * Math.PI;
            a.push(new Asteroides(xInit, yInit, radius, direction, color))
            }
            angleS=0
            n.push(new Nav (W/2,H/2,30,'orange'))

        }
	</script>
</body>
</html>